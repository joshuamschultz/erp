(function(){var e,t,n,i,a=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};e=jQuery,e.fn.disableClientSideValidations=function(){return ClientSideValidations.disable(this),this},e.fn.enableClientSideValidations=function(){return this.filter(ClientSideValidations.selectors.forms).each(function(){return ClientSideValidations.enablers.form(this)}),this.filter(ClientSideValidations.selectors.inputs).each(function(){return ClientSideValidations.enablers.input(this)}),this},e.fn.resetClientSideValidations=function(){return this.filter(ClientSideValidations.selectors.forms).each(function(){return ClientSideValidations.reset(this)}),this},e.fn.validate=function(){return this.filter(ClientSideValidations.selectors.forms).each(function(){return e(this).enableClientSideValidations()}),this},e.fn.isValid=function(a){var s;return s=e(this[0]),s.is("form")?n(s,a):t(s,i(this[0].name,a))},i=function(e,t){var n,i,a;if(n=e.match(/\[(\w+_attributes)\].*\[(\w+)\]$/))for(a in t)i=t[a],a.match("\\["+n[1]+"\\].*\\[\\]\\["+n[2]+"\\]$")&&(e=e.replace(/\[[\da-z_]+\]\[(\w+)\]$/g,"[][$1]"));return t[e]||{}},n=function(t,n){var i;return t.trigger("form:validate:before.ClientSideValidations"),i=!0,t.find(ClientSideValidations.selectors.validate_inputs).each(function(){return e(this).isValid(n)||(i=!1),!0}),i?t.trigger("form:validate:pass.ClientSideValidations"):t.trigger("form:validate:fail.ClientSideValidations"),t.trigger("form:validate:after.ClientSideValidations"),i},t=function(t,n){var i,a,s,r,o,l,d;return t.trigger("element:validate:before.ClientSideValidations"),l=function(){return t.trigger("element:validate:pass.ClientSideValidations").data("valid",null)},r=function(e){return t.trigger("element:validate:fail.ClientSideValidations",e).data("valid",!1),!1},i=function(){return t.trigger("element:validate:after.ClientSideValidations").data("valid")!==!1},s=function(e){var i,a,s,o,l,d,u,c;o=!0;for(a in e)if(i=e[a],n[a]){for(c=n[a],d=0,u=c.length;u>d;d++)if(l=c[d],s=i.call(e,t,l)){o=r(s);break}if(!o)break}return o},a=t.attr("name").replace(/\[([^\]]*?)\]$/,"[_destroy]"),e("input[name='"+a+"']").val()==="1"?(l(),i()):t.data("changed")===!1?i():(t.data("changed",!1),o=ClientSideValidations.validators.local,d=ClientSideValidations.validators.remote,s(o)&&s(d)&&l(),i())},window.ClientSideValidations===void 0&&(window.ClientSideValidations={}),window.ClientSideValidations.forms===void 0&&(window.ClientSideValidations.forms={}),window.ClientSideValidations.selectors={inputs:':input:not(button):not([type="submit"])[name]:visible:enabled',validate_inputs:":input:enabled:visible[data-validate]",forms:"form[data-validate]"},window.ClientSideValidations.reset=function(t){var n,i;n=e(t),ClientSideValidations.disable(t);for(i in t.ClientSideValidations.settings.validators)t.ClientSideValidations.removeError(n.find("[name='"+i+"']"));return ClientSideValidations.enablers.form(t)},window.ClientSideValidations.disable=function(t){var n;return n=e(t),n.off(".ClientSideValidations"),n.is("form")?ClientSideValidations.disable(n.find(":input")):(n.removeData("valid"),n.removeData("changed"),n.filter(":input").each(function(){return e(this).removeAttr("data-validate")}))},window.ClientSideValidations.enablers={form:function(t){var n,i,a,s;n=e(t),t.ClientSideValidations={settings:window.ClientSideValidations.forms[n.attr("id")],addError:function(e,n){return ClientSideValidations.formBuilders[t.ClientSideValidations.settings.type].add(e,t.ClientSideValidations.settings,n)},removeError:function(e){return ClientSideValidations.formBuilders[t.ClientSideValidations.settings.type].remove(e,t.ClientSideValidations.settings)}},s={"submit.ClientSideValidations":function(e){return n.isValid(t.ClientSideValidations.settings.validators)?void 0:(e.preventDefault(),e.stopImmediatePropagation())},"ajax:beforeSend.ClientSideValidations":function(e){return e.target===this?n.isValid(t.ClientSideValidations.settings.validators):void 0},"form:validate:after.ClientSideValidations":function(e){return ClientSideValidations.callbacks.form.after(n,e)},"form:validate:before.ClientSideValidations":function(e){return ClientSideValidations.callbacks.form.before(n,e)},"form:validate:fail.ClientSideValidations":function(e){return ClientSideValidations.callbacks.form.fail(n,e)},"form:validate:pass.ClientSideValidations":function(e){return ClientSideValidations.callbacks.form.pass(n,e)}};for(a in s)i=s[a],n.on(a,i);return n.find(ClientSideValidations.selectors.inputs).each(function(){return ClientSideValidations.enablers.input(this)})},input:function(t){var n,i,a,s,r,o;i=e(t),r=t.form,n=e(r),o={"focusout.ClientSideValidations":function(){return e(this).isValid(r.ClientSideValidations.settings.validators)},"change.ClientSideValidations":function(){return e(this).data("changed",!0)},"element:validate:after.ClientSideValidations":function(t){return ClientSideValidations.callbacks.element.after(e(this),t)},"element:validate:before.ClientSideValidations":function(t){return ClientSideValidations.callbacks.element.before(e(this),t)},"element:validate:fail.ClientSideValidations":function(t,n){var i;return i=e(this),ClientSideValidations.callbacks.element.fail(i,n,function(){return r.ClientSideValidations.addError(i,n)},t)},"element:validate:pass.ClientSideValidations":function(t){var n;return n=e(this),ClientSideValidations.callbacks.element.pass(n,function(){return r.ClientSideValidations.removeError(n)},t)}};for(s in o)a=o[s],i.filter(":not(:radio):not([id$=_confirmation])").each(function(){return e(this).attr("data-validate",!0)}).on(s,a);return i.filter(":checkbox").on("click.ClientSideValidations",function(){return e(this).isValid(r.ClientSideValidations.settings.validators),!0}),i.filter("[id$=_confirmation]").each(function(){var t,i,o,l;if(t=e(this),i=n.find("#"+this.id.match(/(.+)_confirmation/)[1]+":input"),i[0]){o={"focusout.ClientSideValidations":function(){return i.data("changed",!0).isValid(r.ClientSideValidations.settings.validators)},"keyup.ClientSideValidations":function(){return i.data("changed",!0).isValid(r.ClientSideValidations.settings.validators)}},l=[];for(s in o)a=o[s],l.push(e("#"+t.attr("id")).on(s,a));return l}})}},window.ClientSideValidations.validators={all:function(){return jQuery.extend({},ClientSideValidations.validators.local,ClientSideValidations.validators.remote)},local:{presence:function(e,t){return/^\s*$/.test(e.val()||"")?t.message:void 0},acceptance:function(e,t){var n;switch(e.attr("type")){case"checkbox":if(!e.prop("checked"))return t.message;break;case"text":if(e.val()!==(((n=t.accept)!=null?n.toString():void 0)||"1"))return t.message}},format:function(e,t){var n;if(n=this.presence(e,t)){if(t.allow_blank===!0)return;return n}return t["with"]&&!t["with"].test(e.val())?t.message:t.without&&t.without.test(e.val())?t.message:void 0},numericality:function(t,n){var i,a,s,r,o,l,d;if(d=jQuery.trim(t.val()),!ClientSideValidations.patterns.numericality.test(d)){if(n.allow_blank===!0&&this.presence(t,{message:n.messages.numericality}))return;return n.messages.numericality}if(d=d.replace(new RegExp("\\"+ClientSideValidations.number_format.delimiter,"g"),"").replace(new RegExp("\\"+ClientSideValidations.number_format.separator,"g"),"."),n.only_integer&&!/^[+-]?\d+$/.test(d))return n.messages.only_integer;i={greater_than:">",greater_than_or_equal_to:">=",equal_to:"==",less_than:"<",less_than_or_equal_to:"<="},o=e(t[0].form);for(a in i)if(l=i[a],n[a]!=null){if(!isNaN(parseFloat(n[a]))&&isFinite(n[a]))s=n[a];else{if(o.find("[name*="+n[a]+"]").size()!==1)return;s=o.find("[name*="+n[a]+"]").val()}if(r=new Function("return "+d+" "+l+" "+s),!r())return n.messages[a]}return!n.odd||parseInt(d,10)%2?n.even&&parseInt(d,10)%2?n.messages.even:void 0:n.messages.odd},length:function(e,t){var n,i,a,s,r,o,l,d;if(d=t.js_tokenizer||"split('')",l=new Function("element","return (element.val()."+d+" || '').length")(e),n={is:"==",minimum:">=",maximum:"<="},i={},i.message=t.is?t.messages.is:t.minimum?t.messages.minimum:void 0,r=this.presence(e,i)){if(t.allow_blank===!0)return;return r}for(a in n)if(o=n[a],t[a]&&(s=new Function("return "+l+" "+o+" "+t[a]),!s()))return t.messages[a]},exclusion:function(e,t){var n,i,s,r,o;if(i=this.presence(e,t)){if(t.allow_blank===!0)return;return i}return t["in"]&&(o=e.val(),a.call(function(){var e,n,i,a;for(i=t["in"],a=[],e=0,n=i.length;n>e;e++)s=i[e],a.push(s.toString());return a}(),o)>=0)?t.message:t.range&&(n=t.range[0],r=t.range[1],e.val()>=n&&e.val()<=r)?t.message:void 0},inclusion:function(e,t){var n,i,s,r,o;if(i=this.presence(e,t)){if(t.allow_blank===!0)return;return i}if(t["in"]){if(o=e.val(),a.call(function(){var e,n,i,a;for(i=t["in"],a=[],e=0,n=i.length;n>e;e++)s=i[e],a.push(s.toString());return a}(),o)>=0)return;return t.message}if(t.range){if(n=t.range[0],r=t.range[1],e.val()>=n&&e.val()<=r)return;return t.message}},confirmation:function(e,t){return e.val()!==jQuery("#"+e.attr("id")+"_confirmation").val()?t.message:void 0},uniqueness:function(t,n){var i,a,s,r,o,l,d;return s=t.attr("name"),/_attributes\]\[\d/.test(s)&&(a=s.match(/^(.+_attributes\])\[\d+\](.+)$/),r=a[1],o=a[2],d=t.val(),r&&o&&(i=t.closest("form"),l=!0,i.find(':input[name^="'+r+'"][name$="'+o+'"]').each(function(){if(e(this).attr("name")!==s){if(e(this).val()===d)return l=!1,e(this).data("notLocallyUnique",!0);if(e(this).data("notLocallyUnique"))return e(this).removeData("notLocallyUnique").data("changed",!0)}}),!l))?n.message:void 0}},remote:{uniqueness:function(e,t){var n,i,a,s,r,o,l,d;if(a=ClientSideValidations.validators.local.presence(e,t)){if(t.allow_blank===!0)return;return a}if(n={},n.case_sensitive=!!t.case_sensitive,t.id&&(n.id=t.id),t.scope){n.scope={},d=t.scope;for(i in d)r=d[i],l=e.attr("name").replace(/\[\w+\]$/,"["+i+"]"),o=jQuery("[name='"+l+"']"),jQuery("[name='"+l+"']:checkbox").each(function(){return this.checked?o=this:void 0}),o[0]&&o.val()!==r?(n.scope[i]=o.val(),o.unbind("change."+e.id).bind("change."+e.id,function(){return e.trigger("change.ClientSideValidations"),e.trigger("focusout.ClientSideValidations")})):n.scope[i]=r}return/_attributes\]/.test(e.attr("name"))?(s=e.attr("name").match(/\[\w+_attributes\]/g).pop().match(/\[(\w+)_attributes\]/).pop(),s+=/(\[\w+\])$/.exec(e.attr("name"))[1]):s=e.attr("name"),t["class"]&&(s=t["class"]+"["+s.split("[")[1]),n[s]=e.val(),jQuery.ajax({url:ClientSideValidations.remote_validators_url_for("uniqueness"),data:n,async:!1,cache:!1}).status===200?t.message:void 0}}},window.ClientSideValidations.remote_validators_url_for=function(e){return ClientSideValidations.remote_validators_prefix!=null?"//"+window.location.host+"/"+ClientSideValidations.remote_validators_prefix+"/validators/"+e:"//"+window.location.host+"/validators/"+e},window.ClientSideValidations.disableValidators=function(){var e,t,n,i;if(window.ClientSideValidations.disabled_validators!==void 0){n=window.ClientSideValidations.validators.remote,i=[];for(t in n)e=n[t],a.call(window.ClientSideValidations.disabled_validators,t)>=0?i.push(delete window.ClientSideValidations.validators.remote[t]):i.push(void 0);return i}},window.ClientSideValidations.formBuilders={"ActionView::Helpers::FormBuilder":{add:function(t,n,i){var a,s,r,o;return a=e(t[0].form),t.data("valid")!==!1&&a.find("label.message[for='"+t.attr("id")+"']")[0]==null&&(s=jQuery(n.input_tag),o=jQuery(n.label_tag),r=a.find("label[for='"+t.attr("id")+"']:not(.message)"),t.attr("autofocus")&&t.attr("autofocus",!1),t.before(s),s.find("span#input_tag").replaceWith(t),s.find("label.message").attr("for",t.attr("id")),o.find("label.message").attr("for",t.attr("id")),o.insertAfter(r),o.find("label#label_tag").replaceWith(r)),a.find("label.message[for='"+t.attr("id")+"']").text(i)},remove:function(t,n){var i,a,s,r,o;return a=e(t[0].form),i=jQuery(n.input_tag).attr("class"),s=t.closest("."+i.replace(" ",".")),r=a.find("label[for='"+t.attr("id")+"']:not(.message)"),o=r.closest("."+i),s[0]?(s.find("#"+t.attr("id")).detach(),s.replaceWith(t),r.detach(),o.replaceWith(r)):void 0}}},window.ClientSideValidations.patterns={numericality:/^(-|\+)?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d*)?$/},window.ClientSideValidations.callbacks={element:{after:function(){},before:function(){},fail:function(e,t,n){return n()},pass:function(e,t){return t()}},form:{after:function(){},before:function(){},fail:function(){},pass:function(){}}},e(function(){return ClientSideValidations.disableValidators(),e(ClientSideValidations.selectors.forms).validate()})}).call(this),/*
  Client Side Validations - SimpleForm - v2.1.0
  https://github.com/dockyard/client_side_validations-simple_form

  Copyright (c) 2013 DockYard, LLC
  Licensed under the MIT license
  http://www.opensource.org/licenses/mit-license.php
*/
function(){ClientSideValidations.formBuilders["SimpleForm::FormBuilder"]={add:function(e,t,n){return this.wrappers[t.wrapper].add.call(this,e,t,n)},remove:function(e,t){return this.wrappers[t.wrapper].remove.call(this,e,t)},wrappers:{"default":{add:function(e,t,n){var i,a;return i=e.parent().find(""+t.error_tag+"."+t.error_class),a=e.closest(t.wrapper_tag),i[0]==null&&(i=$("<"+t.error_tag+"/>",{"class":t.error_class,text:n}),a.append(i)),a.addClass(t.wrapper_error_class),i.text(n)},remove:function(e,t){var n,i;return i=e.closest(""+t.wrapper_tag+"."+t.wrapper_error_class),i.removeClass(t.wrapper_error_class),n=i.find(""+t.error_tag+"."+t.error_class),n.remove()}},bootstrap:{add:function(e,t,n){var i,a,s;return i=e.parent().find(""+t.error_tag+"."+t.error_class),i[0]==null&&(s=e.closest(t.wrapper_tag),i=$("<"+t.error_tag+"/>",{"class":t.error_class,text:n}),s.append(i)),a=e.closest("."+t.wrapper_class),a.addClass(t.wrapper_error_class),i.text(n)},remove:function(e,t){var n,i,a;return i=e.closest("."+t.wrapper_class+"."+t.wrapper_error_class),a=e.closest(t.wrapper_tag),i.removeClass(t.wrapper_error_class),n=a.find(""+t.error_tag+"."+t.error_class),n.remove()}}}}}.call(this),function(){$(document).ready(function(){return $("div.control-group").focusout(function(){return $("div.control-group").hasClass("error")?void 0:$(this).addClass("success")})})}.call(this),ClientSideValidations.formBuilders["SimpleForm::FormBuilder"]={add:function(e,t,n){var i,a;return t.wrapper_tag=".control-group",t.error_tag="span",t.error_class="help-inline",t.wrapper_error_class="error",t.wrapper_success="success",e.data("valid")!==!1?(a=e.closest(t.wrapper_tag),a.removeClass(t.wrapper_success),a.addClass(t.wrapper_error_class),i=$("<"+t.error_tag+"/>",{"class":t.error_class,text:n}),a.find(".controls").append(i)):(a=e.closest(t.wrapper_tag),a.addClass(t.wrapper_error_class),e.parent().find(""+t.error_tag+"."+t.error_class).text(n))},remove:function(e,t){var n,i;return t.wrapper_tag=".control-group",t.error_tag="span",t.error_class="help-inline",t.wrapper_error_class="error",t.wrapper_success="success",i=e.closest(""+t.wrapper_tag+"."+t.wrapper_error_class),i.removeClass(t.wrapper_error_class),i.addClass(t.wrapper_success),n=i.find(""+t.error_tag+"."+t.error_class),n.remove()}};